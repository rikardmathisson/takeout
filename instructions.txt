# Backup av Google Foto

## Vad

Detta är en enkel implementation av en delvis manuell process att hämta hem alla familjens foton från Google Photos till en katalog på NAS där alla bilderna ligger, med rätt fildatum.

Detta kallas av Google själva för Google Takeout och måste beställas via Google-kontot. Tyvärr måste jag be dig googla på hur man gör den inställningen.

Därefter får man mail ett antal ggr per år med en nedladdningslänk (dagen före kommer en förvarning via mail att processen pågår). 

Att ladda ner fotona gör man i bulk, man får dem huller om buller lagrade i ett större antal .tgz-filer. Detta är unix-arkivfiler som du måste processa.

_Målet är att få våra foton läsbara från NAS:en och då vill vi att alla filer har rätt datum!_

Google Takeout skickar med metadatafiler (.json) för varje enskild mediafil, och katalog. Detta är inte möljigt att processa för hand. Dels för att det är över 50k bilder och lika många metadatafiler och del för att det faktiskt inte går att sätta datum manuellt på filer.

Lösningen är att installera det program jag skrivit. Det finns tillgänglig på github vid behov:

`github.com:rikardmathisson/takeout.git`

Scriptet är också lagrat på NAS:/GooglePhotosTakeout/scripts!

Det går bra att köra på mac, men om allt skall fungera bra måste du ha:
- python version 3
- rsync version 3 eller senare


## Hur

1. Genomför först en komplett export av Google Takeout / Google Foto med din webbläsare, t ex till din lokala downloadmapp.

2. Du får då en lista på filer som ser ut ungefär såhär:

```bash
takeout-20260213T163706Z-3-001.tgz
takeout-20260213T163706Z-3-002.tgz
takeout-20260213T163706Z-3-003.tgz
takeout-20260213T163706Z-3-004.tgz
takeout-20260213T163706Z-3-005.tgz
takeout-20260213T163706Z-3-006.tgz
takeout-20260213T163706Z-3-007.tgz
takeout-20260213T163706Z-3-008.tgz
takeout-20260213T163706Z-3-009.tgz
takeout-20260213T163706Z-3-010.tgz
takeout-20260213T163706Z-3-011.tgz
takeout-20260213T163706Z-3-012.tgz
takeout-20260213T163706Z-3-013.tgz
takeout-20260213T163706Z-3-014.tgz
takeout-20260213T163706Z-3-015.tgz
takeout-20260213T163706Z-3-016.tgz
takeout-20260213T163706Z-3-017.tgz
takeout-20260213T163706Z-3-018.tgz
takeout-20260213T163706Z-3-019.tgz
takeout-20260213T163706Z-3-020.tgz
```

3. Kopiera dessa till `smb://nas2.localdomain/GooglePhotosTakeout/exported`

4. Logga in på nas:en och gå till `/share/GooglePhotosTakeout`

5. Kör takeout.sh med parametrar för verbose (-v) och städa upp filer som tagits bort (--delete)

```bash
./script/takeout.sh exported/ ../GoogleDriveBackup/GooglePhotos/ -v --delete
```

6. Kontrollera loggfiler i exported/_logs.

7. Du kan städa bort tgz-källfilerna ur exported/_processed om allt ser bra ut.

8. Även de redundanta kopiorna som ligger i exported/_extracted kan tas bort om allt gått bra.

9. Filerna kommer senare att backupas från GoogleDriveBackup/GooglePhotos till extern destination automatiskt.

Om något gått fel under processen kan du köra om de olika faserna scriptet arbetar i. 

För hjälp, kör `takeout.sh -h`
